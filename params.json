{"name":"nanoplone","tagline":"how low can we go?","body":"# Plone for small devices\r\n\r\nTo let Plone run reasonably well (or at all, in some cases) on low spec devices like the Raspberry Pi, various ARM-based USB-sticks and the like, you need to take some extra measures. In these pages I'll try to document those.\r\n\r\n## Why bother in the first place?\r\nWell, because we can, of course. And because it is fun. And occasionally, even useful. I've given a talk called [plone in your pocket](http://www.slideshare.net/bslash/is-that-a-plone-in-your-pocket) at the Ploneconference 2012 in Arnhem about this.\r\n\r\n## Assumptions\r\nI'll assume you will run a Debian flavor on the device. It should work for other Linux varieties as well. I'm not documenting how to get your device to boot into Linux, as that can be found elsewhere (for the Raspberry it is very easy, for my current favorite devices [Picuntu](http://ubuntu.g8.net/) is the way to go)\r\n\r\n### Operating system tweaks\r\nThe most important factor in getting Plone to run better is to tweak the filesystem. Write speeds on a Raspberry are abysmal. So you want to minimize those. As soon as the filesystem is created, do the following tweaks:\r\n\r\n* tune2fs /dev/xxx -O has_journal -o journal_data_writeback (where /ev/xxx is your partition). This will disable journaling on the ext4 filesystem. Yes, a recovery after an unclean shutdown will take a bit longer. But hey, this is no mission-critical system we're building.\r\n* mount /dev/xxx -o noatime,nodiratime,data=writeback,barrier=0  This will disable some write-intensive options. Note: these are not a good idea on your high-security, high-availability production server...\r\n\r\nAlso, go through the various logging functions on the OS. Debian, being that faithful and rock-solid OS, will by default log everything, sometimes in various places. You can probably do without full enterprise-grade logging on your USB-stick. Go through /etc/syslog.conf and see what you can live without, or just set to \"critical only\".\r\n\r\n## The Plone stack\r\nOn the Plone side of things, surprisingly little has to be tweaked. Make sure you're using Plone 4.3, or if you're playing with Plone 4.2 upgrade Datetime to 3.0.x in your buildout. This saves a **lot** of memory\r\n\r\nAlso, you will want to disable as many languages as you can get away with for your purposes. Only enable the ones you need in your buildout.\r\n\r\nFinally, disable the Zope access logging (if you're not interested in it, if you plan to put NGINX in front of it, and/or if you intend to use another access logging system like Piwik or GoogleAnalytics anyway)\r\nAlso set the Z2 log to \"critical\".\r\n\r\nI've been known to fiddle with the object caches a bit, but that is also depending on the content you're planning to put on your nanoplone.\r\n\r\nOn the lower end of the hardware scale, you shouldn't install both NGINX and Varnish. Varnish alone will do just fine as a webserver and proxy, but it will also eat some memory. No problem on the newer devices with 1Gb or more memory, not a good plan if you're at 512mb or under. Then, use NGINX, and hope for the best ;-)\r\n\r\n### feedback\r\nupdates, corrections, and the like more than welcome. That goes best by creating an [issue](https://github.com/polyester/polyester.github.com/issues) at github, or even better clone and do a pull request!\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}